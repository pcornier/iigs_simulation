#!/usr/bin/env python3
"""
Generate chr.mem from KEGS kegsfont.h for Apple IIgs character ROM

KEGS font layout (256 chars, 8 bytes each):
  0x00-0x3F: Inverse chars (stored inverted - high bits set)
  0x40-0x5F: MouseText (stored non-inverted)
  0x60-0x7F: Lowercase (stored inverted)
  0x80-0xFF: Normal chars (stored non-inverted)

Our chr.mem layout (4096 bytes, 12-bit address):
  Address = {1'b0, bit10, bit9, char[5:0], row[2:0]}

  For inverse (0x00-0x3F): bit10=0, bit9=0 -> addr 0x000-0x1FF
  For flash/MouseText (0x40-0x7F with ALTCHARSET): bit10=0, bit9=1 -> addr 0x200-0x3FF
  For normal (0x80-0xBF): bit10=1, bit9=0 -> addr 0x400-0x5FF
  For normal (0xC0-0xFF): bit10=1, bit9=1 -> addr 0x600-0x7FF

  Second half (0x800-0xFFF) is alternate charset (same layout)
"""

# KEGS font data - extracted from kegsfont.h
kegsfont = [
    # 0x00-0x3F: Inverse uppercase (stored inverted)
    [0xc7, 0xbb, 0xab, 0xa3, 0xa7, 0xbf, 0xc3, 0xff],  # 0x00 @
    [0xef, 0xd7, 0xbb, 0xbb, 0x83, 0xbb, 0xbb, 0xff],  # 0x01 A
    [0x87, 0xbb, 0xbb, 0x87, 0xbb, 0xbb, 0x87, 0xff],  # 0x02 B
    [0xc7, 0xbb, 0xbf, 0xbf, 0xbf, 0xbb, 0xc7, 0xff],  # 0x03 C
    [0x87, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0x87, 0xff],  # 0x04 D
    [0x83, 0xbf, 0xbf, 0x87, 0xbf, 0xbf, 0x83, 0xff],  # 0x05 E
    [0x83, 0xbf, 0xbf, 0x87, 0xbf, 0xbf, 0xbf, 0xff],  # 0x06 F
    [0xc3, 0xbf, 0xbf, 0xbf, 0xb3, 0xbb, 0xc3, 0xff],  # 0x07 G
    [0xbb, 0xbb, 0xbb, 0x83, 0xbb, 0xbb, 0xbb, 0xff],  # 0x08 H
    [0xc7, 0xef, 0xef, 0xef, 0xef, 0xef, 0xc7, 0xff],  # 0x09 I
    [0xfb, 0xfb, 0xfb, 0xfb, 0xfb, 0xbb, 0xc7, 0xff],  # 0x0a J
    [0xbb, 0xb7, 0xaf, 0x9f, 0xaf, 0xb7, 0xbb, 0xff],  # 0x0b K
    [0xbf, 0xbf, 0xbf, 0xbf, 0xbf, 0xbf, 0x83, 0xff],  # 0x0c L
    [0xbb, 0x93, 0xab, 0xab, 0xbb, 0xbb, 0xbb, 0xff],  # 0x0d M
    [0xbb, 0xbb, 0x9b, 0xab, 0xb3, 0xbb, 0xbb, 0xff],  # 0x0e N
    [0xc7, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xc7, 0xff],  # 0x0f O
    [0x87, 0xbb, 0xbb, 0x87, 0xbf, 0xbf, 0xbf, 0xff],  # 0x10 P
    [0xc7, 0xbb, 0xbb, 0xbb, 0xab, 0xb7, 0xcb, 0xff],  # 0x11 Q
    [0x87, 0xbb, 0xbb, 0x87, 0xaf, 0xb7, 0xbb, 0xff],  # 0x12 R
    [0xc7, 0xbb, 0xbf, 0xc7, 0xfb, 0xbb, 0xc7, 0xff],  # 0x13 S
    [0x83, 0xef, 0xef, 0xef, 0xef, 0xef, 0xef, 0xff],  # 0x14 T
    [0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xc7, 0xff],  # 0x15 U
    [0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xd7, 0xef, 0xff],  # 0x16 V
    [0xbb, 0xbb, 0xbb, 0xab, 0xab, 0x93, 0xbb, 0xff],  # 0x17 W
    [0xbb, 0xbb, 0xd7, 0xef, 0xd7, 0xbb, 0xbb, 0xff],  # 0x18 X
    [0xbb, 0xbb, 0xd7, 0xef, 0xef, 0xef, 0xef, 0xff],  # 0x19 Y
    [0x83, 0xfb, 0xf7, 0xef, 0xdf, 0xbf, 0x83, 0xff],  # 0x1a Z
    [0x83, 0x9f, 0x9f, 0x9f, 0x9f, 0x9f, 0x83, 0xff],  # 0x1b [
    [0xff, 0xbf, 0xdf, 0xef, 0xf7, 0xfb, 0xff, 0xff],  # 0x1c backslash
    [0x83, 0xf3, 0xf3, 0xf3, 0xf3, 0xf3, 0x83, 0xff],  # 0x1d ]
    [0xff, 0xff, 0xef, 0xd7, 0xbb, 0xff, 0xff, 0xff],  # 0x1e ^
    [0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01],  # 0x1f _
    [0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff],  # 0x20 space
    [0xef, 0xef, 0xef, 0xef, 0xef, 0xff, 0xef, 0xff],  # 0x21 !
    [0xd7, 0xd7, 0xd7, 0xff, 0xff, 0xff, 0xff, 0xff],  # 0x22 "
    [0xd7, 0xd7, 0x83, 0xd7, 0x83, 0xd7, 0xd7, 0xff],  # 0x23 #
    [0xef, 0xc3, 0xaf, 0xc7, 0xeb, 0x87, 0xef, 0xff],  # 0x24 $
    [0x9f, 0x9b, 0xf7, 0xef, 0xdf, 0xb3, 0xf3, 0xff],  # 0x25 %
    [0xdf, 0xaf, 0xaf, 0xdf, 0xab, 0xb7, 0xcb, 0xff],  # 0x26 &
    [0xef, 0xef, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff],  # 0x27 '
    [0xef, 0xdf, 0xbf, 0xbf, 0xbf, 0xdf, 0xef, 0xff],  # 0x28 (
    [0xef, 0xf7, 0xfb, 0xfb, 0xfb, 0xf7, 0xef, 0xff],  # 0x29 )
    [0xef, 0xab, 0xc7, 0xef, 0xc7, 0xab, 0xef, 0xff],  # 0x2a *
    [0xff, 0xef, 0xef, 0x83, 0xef, 0xef, 0xff, 0xff],  # 0x2b +
    [0xff, 0xff, 0xff, 0xff, 0xef, 0xef, 0xdf, 0xff],  # 0x2c ,
    [0xff, 0xff, 0xff, 0x83, 0xff, 0xff, 0xff, 0xff],  # 0x2d -
    [0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xef, 0xff],  # 0x2e .
    [0xff, 0xfb, 0xf7, 0xef, 0xdf, 0xbf, 0xff, 0xff],  # 0x2f /
    [0xc7, 0xbb, 0xb3, 0xab, 0x9b, 0xbb, 0xc7, 0xff],  # 0x30 0
    [0xef, 0xcf, 0xef, 0xef, 0xef, 0xef, 0xc7, 0xff],  # 0x31 1
    [0xc7, 0xbb, 0xfb, 0xe7, 0xdf, 0xbf, 0x83, 0xff],  # 0x32 2
    [0x83, 0xfb, 0xf7, 0xe7, 0xfb, 0xbb, 0xc7, 0xff],  # 0x33 3
    [0xf7, 0xe7, 0xd7, 0xb7, 0x83, 0xf7, 0xf7, 0xff],  # 0x34 4
    [0x83, 0xbf, 0x87, 0xfb, 0xfb, 0xbb, 0xc7, 0xff],  # 0x35 5
    [0xe3, 0xdf, 0xbf, 0x87, 0xbb, 0xbb, 0xc7, 0xff],  # 0x36 6
    [0x83, 0xfb, 0xf7, 0xef, 0xdf, 0xdf, 0xdf, 0xff],  # 0x37 7
    [0xc7, 0xbb, 0xbb, 0xc7, 0xbb, 0xbb, 0xc7, 0xff],  # 0x38 8
    [0xc7, 0xbb, 0xbb, 0xc3, 0xfb, 0xf7, 0x8f, 0xff],  # 0x39 9
    [0xff, 0xff, 0xef, 0xff, 0xef, 0xff, 0xff, 0xff],  # 0x3a :
    [0xff, 0xff, 0xef, 0xff, 0xef, 0xef, 0xdf, 0xff],  # 0x3b ;
    [0xf7, 0xef, 0xdf, 0xbf, 0xdf, 0xef, 0xf7, 0xff],  # 0x3c <
    [0xff, 0xff, 0x83, 0xff, 0x83, 0xff, 0xff, 0xff],  # 0x3d =
    [0xdf, 0xef, 0xf7, 0xfb, 0xf7, 0xef, 0xdf, 0xff],  # 0x3e >
    [0xc7, 0xbb, 0xf7, 0xef, 0xef, 0xff, 0xef, 0xff],  # 0x3f ?

    # 0x40-0x5F: MouseText (IIgs specific, stored non-inverted)
    [0x08, 0x10, 0x6c, 0xfe, 0xfc, 0xfc, 0x7e, 0x6c],  # 0x40 closed folder
    [0x08, 0x10, 0x6c, 0x82, 0x84, 0x84, 0x52, 0x6c],  # 0x41 open folder
    [0x00, 0x00, 0x40, 0x60, 0x70, 0x78, 0x6c, 0x42],  # 0x42
    [0xfe, 0x44, 0x28, 0x10, 0x10, 0x28, 0x54, 0xfe],  # 0x43
    [0x00, 0x02, 0x04, 0x88, 0x50, 0x20, 0x20, 0x00],  # 0x44
    [0xfe, 0xfc, 0xfa, 0x36, 0xae, 0xde, 0xde, 0xfe],  # 0x45
    [0xfc, 0xfc, 0xfc, 0xdc, 0x9c, 0x00, 0x9e, 0xde],  # 0x46
    [0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0x00, 0xfe],  # 0x47
    [0x10, 0x20, 0x40, 0xfe, 0x40, 0x20, 0x10, 0x00],  # 0x48
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x54],  # 0x49
    [0x10, 0x10, 0x10, 0x10, 0x92, 0x54, 0x38, 0x10],  # 0x4a
    [0x10, 0x38, 0x54, 0x92, 0x10, 0x10, 0x10, 0x10],  # 0x4b
    [0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0x4c
    [0x02, 0x02, 0x02, 0x22, 0x62, 0xfe, 0x60, 0x20],  # 0x4d
    [0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc],  # 0x4e
    [0xc8, 0x18, 0x38, 0x7e, 0x38, 0x18, 0x08, 0xf6],  # 0x4f
    [0x26, 0x30, 0x38, 0xfc, 0x38, 0x30, 0x20, 0xde],  # 0x50
    [0x02, 0x12, 0x10, 0xfe, 0x7c, 0x38, 0x12, 0x02],  # 0x51
    [0x02, 0x12, 0x38, 0x7c, 0xfe, 0x10, 0x12, 0x02],  # 0x52
    [0x00, 0x00, 0x00, 0xfe, 0x00, 0x00, 0x00, 0x00],  # 0x53
    [0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xfe],  # 0x54
    [0x10, 0x08, 0x04, 0xfe, 0x04, 0x08, 0x10, 0x00],  # 0x55
    [0x54, 0xaa, 0x54, 0xaa, 0x54, 0xaa, 0x54, 0xaa],  # 0x56
    [0xaa, 0x54, 0xaa, 0x54, 0xaa, 0x54, 0xaa, 0x54],  # 0x57
    [0x00, 0x7c, 0x82, 0x80, 0x80, 0x80, 0xfe, 0x00],  # 0x58
    [0x00, 0x00, 0xfc, 0x02, 0x02, 0x02, 0xfe, 0x00],  # 0x59
    [0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02],  # 0x5a
    [0x10, 0x38, 0x7c, 0xfe, 0x7c, 0x38, 0x10, 0x00],  # 0x5b
    [0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe],  # 0x5c
    [0x28, 0x28, 0xee, 0x00, 0xee, 0x28, 0x28, 0x00],  # 0x5d
    [0xfe, 0x02, 0x02, 0x32, 0x32, 0x02, 0x02, 0xfe],  # 0x5e
    [0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80],  # 0x5f

    # 0x60-0x7F: Lowercase (stored inverted)
    [0xdf, 0xef, 0xf7, 0xff, 0xff, 0xff, 0xff, 0xff],  # 0x60 `
    [0xff, 0xff, 0xc7, 0xfb, 0xc3, 0xbb, 0xc3, 0xff],  # 0x61 a
    [0xbf, 0xbf, 0x87, 0xbb, 0xbb, 0xbb, 0x87, 0xff],  # 0x62 b
    [0xff, 0xff, 0xc3, 0xbf, 0xbf, 0xbf, 0xc3, 0xff],  # 0x63 c
    [0xfb, 0xfb, 0xc3, 0xbb, 0xbb, 0xbb, 0xc3, 0xff],  # 0x64 d
    [0xff, 0xff, 0xc7, 0xbb, 0x83, 0xbf, 0xc3, 0xff],  # 0x65 e
    [0xe7, 0xdb, 0xdf, 0x87, 0xdf, 0xdf, 0xdf, 0xff],  # 0x66 f
    [0xff, 0xff, 0xc7, 0xbb, 0xbb, 0xc3, 0xfb, 0xc7],  # 0x67 g
    [0xbf, 0xbf, 0x87, 0xbb, 0xbb, 0xbb, 0xbb, 0xff],  # 0x68 h
    [0xef, 0xff, 0xcf, 0xef, 0xef, 0xef, 0xc7, 0xff],  # 0x69 i
    [0xf7, 0xff, 0xe7, 0xf7, 0xf7, 0xf7, 0xb7, 0xcf],  # 0x6a j
    [0xbf, 0xbf, 0xbb, 0xb7, 0x8f, 0xb7, 0xbb, 0xff],  # 0x6b k
    [0xcf, 0xef, 0xef, 0xef, 0xef, 0xef, 0xc7, 0xff],  # 0x6c l
    [0xff, 0xff, 0x93, 0xab, 0xab, 0xab, 0xbb, 0xff],  # 0x6d m
    [0xff, 0xff, 0x87, 0xbb, 0xbb, 0xbb, 0xbb, 0xff],  # 0x6e n
    [0xff, 0xff, 0xc7, 0xbb, 0xbb, 0xbb, 0xc7, 0xff],  # 0x6f o
    [0xff, 0xff, 0x87, 0xbb, 0xbb, 0x87, 0xbf, 0xbf],  # 0x70 p
    [0xff, 0xff, 0xc3, 0xbb, 0xbb, 0xc3, 0xfb, 0xfb],  # 0x71 q
    [0xff, 0xff, 0xa3, 0x9f, 0xbf, 0xbf, 0xbf, 0xff],  # 0x72 r
    [0xff, 0xff, 0xc3, 0xbf, 0xc7, 0xfb, 0x87, 0xff],  # 0x73 s
    [0xdf, 0xdf, 0x87, 0xdf, 0xdf, 0xdb, 0xe7, 0xff],  # 0x74 t
    [0xff, 0xff, 0xbb, 0xbb, 0xbb, 0xb3, 0xcb, 0xff],  # 0x75 u
    [0xff, 0xff, 0xbb, 0xbb, 0xbb, 0xd7, 0xef, 0xff],  # 0x76 v
    [0xff, 0xff, 0xbb, 0xbb, 0xab, 0xab, 0x93, 0xff],  # 0x77 w
    [0xff, 0xff, 0xbb, 0xd7, 0xef, 0xd7, 0xbb, 0xff],  # 0x78 x
    [0xff, 0xff, 0xbb, 0xbb, 0xbb, 0xc3, 0xfb, 0xc7],  # 0x79 y
    [0xff, 0xff, 0x83, 0xf7, 0xef, 0xdf, 0x83, 0xff],  # 0x7a z
    [0xe3, 0xcf, 0xcf, 0x9f, 0xcf, 0xcf, 0xe3, 0xff],  # 0x7b {
    [0xef, 0xef, 0xef, 0xef, 0xef, 0xef, 0xef, 0xef],  # 0x7c |
    [0x8f, 0xe7, 0xe7, 0xf3, 0xe7, 0xe7, 0x8f, 0xff],  # 0x7d }
    [0xcb, 0xa7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff],  # 0x7e ~
    [0xff, 0xab, 0xd7, 0xab, 0xd7, 0xab, 0xff, 0xff],  # 0x7f DEL

    # 0x80-0xBF: Normal uppercase (stored non-inverted)
    [0x38, 0x44, 0x54, 0x5c, 0x58, 0x40, 0x3c, 0x00],  # 0x80 @
    [0x10, 0x28, 0x44, 0x44, 0x7c, 0x44, 0x44, 0x00],  # 0x81 A
    [0x78, 0x44, 0x44, 0x78, 0x44, 0x44, 0x78, 0x00],  # 0x82 B
    [0x38, 0x44, 0x40, 0x40, 0x40, 0x44, 0x38, 0x00],  # 0x83 C
    [0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x78, 0x00],  # 0x84 D
    [0x7c, 0x40, 0x40, 0x78, 0x40, 0x40, 0x7c, 0x00],  # 0x85 E
    [0x7c, 0x40, 0x40, 0x78, 0x40, 0x40, 0x40, 0x00],  # 0x86 F
    [0x3c, 0x40, 0x40, 0x40, 0x4c, 0x44, 0x3c, 0x00],  # 0x87 G
    [0x44, 0x44, 0x44, 0x7c, 0x44, 0x44, 0x44, 0x00],  # 0x88 H
    [0x38, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38, 0x00],  # 0x89 I
    [0x04, 0x04, 0x04, 0x04, 0x04, 0x44, 0x38, 0x00],  # 0x8a J
    [0x44, 0x48, 0x50, 0x60, 0x50, 0x48, 0x44, 0x00],  # 0x8b K
    [0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7c, 0x00],  # 0x8c L
    [0x44, 0x6c, 0x54, 0x54, 0x44, 0x44, 0x44, 0x00],  # 0x8d M
    [0x44, 0x44, 0x64, 0x54, 0x4c, 0x44, 0x44, 0x00],  # 0x8e N
    [0x38, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x00],  # 0x8f O
    [0x78, 0x44, 0x44, 0x78, 0x40, 0x40, 0x40, 0x00],  # 0x90 P
    [0x38, 0x44, 0x44, 0x44, 0x54, 0x48, 0x34, 0x00],  # 0x91 Q
    [0x78, 0x44, 0x44, 0x78, 0x50, 0x48, 0x44, 0x00],  # 0x92 R
    [0x38, 0x44, 0x40, 0x38, 0x04, 0x44, 0x38, 0x00],  # 0x93 S
    [0x7c, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00],  # 0x94 T
    [0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x00],  # 0x95 U
    [0x44, 0x44, 0x44, 0x44, 0x44, 0x28, 0x10, 0x00],  # 0x96 V
    [0x44, 0x44, 0x44, 0x54, 0x54, 0x6c, 0x44, 0x00],  # 0x97 W
    [0x44, 0x44, 0x28, 0x10, 0x28, 0x44, 0x44, 0x00],  # 0x98 X
    [0x44, 0x44, 0x28, 0x10, 0x10, 0x10, 0x10, 0x00],  # 0x99 Y
    [0x7c, 0x04, 0x08, 0x10, 0x20, 0x40, 0x7c, 0x00],  # 0x9a Z
    [0x7c, 0x60, 0x60, 0x60, 0x60, 0x60, 0x7c, 0x00],  # 0x9b [
    [0x00, 0x40, 0x20, 0x10, 0x08, 0x04, 0x00, 0x00],  # 0x9c backslash
    [0x7c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x7c, 0x00],  # 0x9d ]
    [0x00, 0x00, 0x10, 0x28, 0x44, 0x00, 0x00, 0x00],  # 0x9e ^
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe],  # 0x9f _
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0xa0 space
    [0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x10, 0x00],  # 0xa1 !
    [0x28, 0x28, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0xa2 "
    [0x28, 0x28, 0x7c, 0x28, 0x7c, 0x28, 0x28, 0x00],  # 0xa3 #
    [0x10, 0x3c, 0x50, 0x38, 0x14, 0x78, 0x10, 0x00],  # 0xa4 $
    [0x60, 0x64, 0x08, 0x10, 0x20, 0x4c, 0x0c, 0x00],  # 0xa5 %
    [0x20, 0x50, 0x50, 0x20, 0x54, 0x48, 0x34, 0x00],  # 0xa6 &
    [0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0xa7 '
    [0x10, 0x20, 0x40, 0x40, 0x40, 0x20, 0x10, 0x00],  # 0xa8 (
    [0x10, 0x08, 0x04, 0x04, 0x04, 0x08, 0x10, 0x00],  # 0xa9 )
    [0x10, 0x54, 0x38, 0x10, 0x38, 0x54, 0x10, 0x00],  # 0xaa *
    [0x00, 0x10, 0x10, 0x7c, 0x10, 0x10, 0x00, 0x00],  # 0xab +
    [0x00, 0x00, 0x00, 0x00, 0x10, 0x10, 0x20, 0x00],  # 0xac ,
    [0x00, 0x00, 0x00, 0x7c, 0x00, 0x00, 0x00, 0x00],  # 0xad -
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00],  # 0xae .
    [0x00, 0x04, 0x08, 0x10, 0x20, 0x40, 0x00, 0x00],  # 0xaf /
    [0x38, 0x44, 0x4c, 0x54, 0x64, 0x44, 0x38, 0x00],  # 0xb0 0
    [0x10, 0x30, 0x10, 0x10, 0x10, 0x10, 0x38, 0x00],  # 0xb1 1
    [0x38, 0x44, 0x04, 0x18, 0x20, 0x40, 0x7c, 0x00],  # 0xb2 2
    [0x7c, 0x04, 0x08, 0x18, 0x04, 0x44, 0x38, 0x00],  # 0xb3 3
    [0x08, 0x18, 0x28, 0x48, 0x7c, 0x08, 0x08, 0x00],  # 0xb4 4
    [0x7c, 0x40, 0x78, 0x04, 0x04, 0x44, 0x38, 0x00],  # 0xb5 5
    [0x1c, 0x20, 0x40, 0x78, 0x44, 0x44, 0x38, 0x00],  # 0xb6 6
    [0x7c, 0x04, 0x08, 0x10, 0x20, 0x20, 0x20, 0x00],  # 0xb7 7
    [0x38, 0x44, 0x44, 0x38, 0x44, 0x44, 0x38, 0x00],  # 0xb8 8
    [0x38, 0x44, 0x44, 0x3c, 0x04, 0x08, 0x70, 0x00],  # 0xb9 9
    [0x00, 0x00, 0x10, 0x00, 0x10, 0x00, 0x00, 0x00],  # 0xba :
    [0x00, 0x00, 0x10, 0x00, 0x10, 0x10, 0x20, 0x00],  # 0xbb ;
    [0x08, 0x10, 0x20, 0x40, 0x20, 0x10, 0x08, 0x00],  # 0xbc <
    [0x00, 0x00, 0x7c, 0x00, 0x7c, 0x00, 0x00, 0x00],  # 0xbd =
    [0x20, 0x10, 0x08, 0x04, 0x08, 0x10, 0x20, 0x00],  # 0xbe >
    [0x38, 0x44, 0x08, 0x10, 0x10, 0x00, 0x10, 0x00],  # 0xbf ?

    # 0xC0-0xFF: More normal chars (stored non-inverted)
    [0x38, 0x44, 0x54, 0x5c, 0x58, 0x40, 0x3c, 0x00],  # 0xc0 @
    [0x10, 0x28, 0x44, 0x44, 0x7c, 0x44, 0x44, 0x00],  # 0xc1 A
    [0x78, 0x44, 0x44, 0x78, 0x44, 0x44, 0x78, 0x00],  # 0xc2 B
    [0x38, 0x44, 0x40, 0x40, 0x40, 0x44, 0x38, 0x00],  # 0xc3 C
    [0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x78, 0x00],  # 0xc4 D
    [0x7c, 0x40, 0x40, 0x78, 0x40, 0x40, 0x7c, 0x00],  # 0xc5 E
    [0x7c, 0x40, 0x40, 0x78, 0x40, 0x40, 0x40, 0x00],  # 0xc6 F
    [0x3c, 0x40, 0x40, 0x40, 0x4c, 0x44, 0x3c, 0x00],  # 0xc7 G
    [0x44, 0x44, 0x44, 0x7c, 0x44, 0x44, 0x44, 0x00],  # 0xc8 H
    [0x38, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38, 0x00],  # 0xc9 I
    [0x04, 0x04, 0x04, 0x04, 0x04, 0x44, 0x38, 0x00],  # 0xca J
    [0x44, 0x48, 0x50, 0x60, 0x50, 0x48, 0x44, 0x00],  # 0xcb K
    [0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7c, 0x00],  # 0xcc L
    [0x44, 0x6c, 0x54, 0x54, 0x44, 0x44, 0x44, 0x00],  # 0xcd M
    [0x44, 0x44, 0x64, 0x54, 0x4c, 0x44, 0x44, 0x00],  # 0xce N
    [0x38, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x00],  # 0xcf O
    [0x78, 0x44, 0x44, 0x78, 0x40, 0x40, 0x40, 0x00],  # 0xd0 P
    [0x38, 0x44, 0x44, 0x44, 0x54, 0x48, 0x34, 0x00],  # 0xd1 Q
    [0x78, 0x44, 0x44, 0x78, 0x50, 0x48, 0x44, 0x00],  # 0xd2 R
    [0x38, 0x44, 0x40, 0x38, 0x04, 0x44, 0x38, 0x00],  # 0xd3 S
    [0x7c, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00],  # 0xd4 T
    [0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x00],  # 0xd5 U
    [0x44, 0x44, 0x44, 0x44, 0x44, 0x28, 0x10, 0x00],  # 0xd6 V
    [0x44, 0x44, 0x44, 0x54, 0x54, 0x6c, 0x44, 0x00],  # 0xd7 W
    [0x44, 0x44, 0x28, 0x10, 0x28, 0x44, 0x44, 0x00],  # 0xd8 X
    [0x44, 0x44, 0x28, 0x10, 0x10, 0x10, 0x10, 0x00],  # 0xd9 Y
    [0x7c, 0x04, 0x08, 0x10, 0x20, 0x40, 0x7c, 0x00],  # 0xda Z
    [0x7c, 0x60, 0x60, 0x60, 0x60, 0x60, 0x7c, 0x00],  # 0xdb [
    [0x00, 0x40, 0x20, 0x10, 0x08, 0x04, 0x00, 0x00],  # 0xdc backslash
    [0x7c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x7c, 0x00],  # 0xdd ]
    [0x00, 0x00, 0x10, 0x28, 0x44, 0x00, 0x00, 0x00],  # 0xde ^
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe],  # 0xdf _
    [0x20, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0xe0 `
    [0x00, 0x00, 0x38, 0x04, 0x3c, 0x44, 0x3c, 0x00],  # 0xe1 a
    [0x40, 0x40, 0x78, 0x44, 0x44, 0x44, 0x78, 0x00],  # 0xe2 b
    [0x00, 0x00, 0x3c, 0x40, 0x40, 0x40, 0x3c, 0x00],  # 0xe3 c
    [0x04, 0x04, 0x3c, 0x44, 0x44, 0x44, 0x3c, 0x00],  # 0xe4 d
    [0x00, 0x00, 0x38, 0x44, 0x7c, 0x40, 0x3c, 0x00],  # 0xe5 e
    [0x18, 0x24, 0x20, 0x78, 0x20, 0x20, 0x20, 0x00],  # 0xe6 f
    [0x00, 0x00, 0x38, 0x44, 0x44, 0x3c, 0x04, 0x38],  # 0xe7 g
    [0x40, 0x40, 0x78, 0x44, 0x44, 0x44, 0x44, 0x00],  # 0xe8 h
    [0x10, 0x00, 0x30, 0x10, 0x10, 0x10, 0x38, 0x00],  # 0xe9 i
    [0x08, 0x00, 0x18, 0x08, 0x08, 0x08, 0x48, 0x30],  # 0xea j
    [0x40, 0x40, 0x44, 0x48, 0x70, 0x48, 0x44, 0x00],  # 0xeb k
    [0x30, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38, 0x00],  # 0xec l
    [0x00, 0x00, 0x6c, 0x54, 0x54, 0x54, 0x44, 0x00],  # 0xed m
    [0x00, 0x00, 0x78, 0x44, 0x44, 0x44, 0x44, 0x00],  # 0xee n
    [0x00, 0x00, 0x38, 0x44, 0x44, 0x44, 0x38, 0x00],  # 0xef o
    [0x00, 0x00, 0x78, 0x44, 0x44, 0x78, 0x40, 0x40],  # 0xf0 p
    [0x00, 0x00, 0x3c, 0x44, 0x44, 0x3c, 0x04, 0x04],  # 0xf1 q
    [0x00, 0x00, 0x5c, 0x60, 0x40, 0x40, 0x40, 0x00],  # 0xf2 r
    [0x00, 0x00, 0x3c, 0x40, 0x38, 0x04, 0x78, 0x00],  # 0xf3 s
    [0x20, 0x20, 0x78, 0x20, 0x20, 0x24, 0x18, 0x00],  # 0xf4 t
    [0x00, 0x00, 0x44, 0x44, 0x44, 0x4c, 0x34, 0x00],  # 0xf5 u
    [0x00, 0x00, 0x44, 0x44, 0x44, 0x28, 0x10, 0x00],  # 0xf6 v
    [0x00, 0x00, 0x44, 0x44, 0x54, 0x54, 0x6c, 0x00],  # 0xf7 w
    [0x00, 0x00, 0x44, 0x28, 0x10, 0x28, 0x44, 0x00],  # 0xf8 x
    [0x00, 0x00, 0x44, 0x44, 0x44, 0x3c, 0x04, 0x38],  # 0xf9 y
    [0x00, 0x00, 0x7c, 0x08, 0x10, 0x20, 0x7c, 0x00],  # 0xfa z
    [0x1c, 0x30, 0x30, 0x60, 0x30, 0x30, 0x1c, 0x00],  # 0xfb {
    [0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10],  # 0xfc |
    [0x70, 0x18, 0x18, 0x0c, 0x18, 0x18, 0x70, 0x00],  # 0xfd }
    [0x34, 0x58, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],  # 0xfe ~
    [0x00, 0x54, 0x28, 0x54, 0x28, 0x54, 0x00, 0x00],  # 0xff DEL
]

# Bit reversal function - VGC reads bit 0 as leftmost pixel,
# but KEGS stores bit 7 as leftmost pixel (bits 7-1 are the 7 pixels)
def reverse_bits_7(byte):
    """Reverse bits 7-1 of a byte to bits 0-6 (7-bit character width)

    KEGS format: bit 7 = leftmost pixel, bit 1 = rightmost pixel
    VGC format:  bit 0 = leftmost pixel, bit 6 = rightmost pixel
    """
    result = 0
    for i in range(7):
        # KEGS bit (7-i) maps to VGC bit i
        if byte & (1 << (7 - i)):
            result |= (1 << i)
    return result

# Create 4096 byte chr.mem
# Our VGC address: {1'b0, bit10, bit9, char[5:0], row[2:0]}
chr_mem = [0] * 4096

for char_code in range(256):
    char_data = kegsfont[char_code]

    # Determine where this character goes based on video_data encoding
    # video_data[7] = char_code[7], video_data[6] = char_code[6], video_data[5:0] = char_code[5:0]

    for row in range(8):
        byte_val = reverse_bits_7(char_data[row])

        # Calculate address based on character type
        # bit10 = video_data[7] | (video_data[6] & flash_state & ~ALTCHARSET)
        # bit9 = video_data[6] & (ALTCHARSET | video_data[7])

        # For simplicity, we store characters in their natural positions
        # based on how the VGC will access them

        char_low = char_code & 0x3F

        if char_code < 0x40:  # Inverse 0x00-0x3F
            # bit10=0, bit9=0
            addr = (0 << 9) | (char_low << 3) | row
        elif char_code < 0x80:  # Flash/MouseText 0x40-0x7F
            # When ALTCHARSET=1: bit10=0, bit9=1
            addr = (1 << 9) | (char_low << 3) | row
        elif char_code < 0xC0:  # Normal 0x80-0xBF
            # bit10=1, bit9=0
            addr = (2 << 9) | (char_low << 3) | row
        else:  # Normal 0xC0-0xFF
            # bit10=1, bit9=1
            addr = (3 << 9) | (char_low << 3) | row

        chr_mem[addr] = byte_val

# Also fill second half (alternate charset) - for now, copy same data
for i in range(2048):
    chr_mem[2048 + i] = chr_mem[i]

# Write chr.mem file
with open('chr_iigs.mem', 'w') as f:
    for byte in chr_mem:
        f.write(f'{byte:02X}\n')

print("Generated chr_iigs.mem with 4096 bytes")
